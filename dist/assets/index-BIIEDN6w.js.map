{"version":3,"file":"index-BIIEDN6w.js","sources":["../../src/firebase/firebase-config.js","../../src/firebase/firestore.js","../../src/firebase/auth.js","../../src/state.js","../../src/utils/helpers.js","../../src/main.js","../../src/router.js"],"sourcesContent":["//src/firebase/firebase-config.js\r\n\r\nimport { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';\r\n\r\n// Firebase configuration\r\nconst firebaseConfig = {\r\n  apiKey: 'AIzaSyBiscdF0tuWqOHERdRQdNlkvbQsmClDLbo',\r\n  authDomain: 'dreamlog-7dff3.firebaseapp.com',\r\n  databaseURL: 'https://dreamlog-7dff3-default-rtdb.europe-west1.firebasedatabase.app',\r\n  projectId: 'dreamlog-7dff3',\r\n  storageBucket: 'dreamlog-7dff3.appspot.com',\r\n  messagingSenderId: '5989316723',\r\n  appId: '1:5989316723:web:72539d64015f7a5f8cd206',\r\n  measurementId: 'G-F1V81KG437'\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\nexport { app };\r\n","//src/firebase/firestore.js\r\n\r\nimport {\r\n  getFirestore,\r\n  doc,\r\n  updateDoc,\r\n  collection,\r\n  getDocs,\r\n  addDoc,\r\n  deleteDoc,\r\n  query,\r\n  where,\r\n  getDoc,\r\n  setDoc\r\n} from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';\r\nimport { app } from './firebase-config';\r\n\r\nconst db = getFirestore(app);\r\nexport { db };\r\n","// src/firebase/auth.js\r\nimport { getAuth } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';\r\n\r\nimport { app } from './firebase-config';\r\n\r\nconst auth = getAuth(app);\r\nexport { auth };\r\n","// Define shared state variables\r\nexport let currentUser = null;\r\nexport let currentSelectedEntry = null;\r\nexport let base64String = null;\r\nexport let path = null;\r\n\r\n// Functions to update the shared state variables\r\nexport function setCurrentUser(user) {\r\n  currentUser = user;\r\n}\r\n\r\nexport function setCurrentSelectedEntry(entry) {\r\n  currentSelectedEntry = entry;\r\n}\r\n\r\nexport function setBase64String(base64Str) {\r\n  base64String = base64Str;\r\n}\r\n\r\nexport function setPath(newPath) {\r\n  path = newPath;\r\n}\r\n\r\n// Optionally, getter functions for better encapsulation\r\nexport function getCurrentUser() {\r\n  return currentUser;\r\n}\r\n\r\nexport function getCurrentSelectedEntry() {\r\n  return currentSelectedEntry;\r\n}\r\n\r\nexport function getBase64String() {\r\n  return base64String;\r\n}\r\n\r\nexport function getPath() {\r\n  return path;\r\n}\r\n","// src/utils/helpers.js\r\nconsole.log('helpers.js loaded');\r\n\r\nimport { auth } from '/src/firebase/auth.js';\r\nimport { db } from '/src/firebase/firestore.js';\r\nimport {\r\n  getFirestore,\r\n  doc,\r\n  updateDoc,\r\n  collection,\r\n  getDocs,\r\n  addDoc,\r\n  deleteDoc,\r\n  query,\r\n  where,\r\n  getDoc,\r\n  setDoc\r\n} from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';\r\n\r\nimport {\r\n  getAuth,\r\n  signInWithEmailAndPassword,\r\n  onAuthStateChanged,\r\n  createUserWithEmailAndPassword,\r\n  signOut\r\n} from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';\r\n\r\nimport { nanoid } from 'https://cdnjs.cloudflare.com/ajax/libs/nanoid/5.0.7/index.browser.js';\r\nimport {\r\n  setCurrentUser,\r\n  setCurrentSelectedEntry,\r\n  setBase64String,\r\n  setPath,\r\n  getCurrentUser,\r\n  getCurrentSelectedEntry,\r\n  getBase64String,\r\n  getPath\r\n} from '../state.js';\r\n\r\nfunction setNavbarContent() {\r\n  const navbarMenu = document.getElementById('navbar-menu');\r\n  const mobileMenu = document.getElementById('mobile-menu');\r\n\r\n  console.log('trying to set navbar content');\r\n  if (getCurrentUser()) {\r\n    // If user is signed in\r\n\r\n    navbarMenu.innerHTML = `\r\n      <li class=\"navbar__item\"><a href=\"/journal\" data-link class=\"navbar__links\">Journal</a></li>\r\n      <li class=\"navbar__item\"><a href=\"/friends\" data-link class=\"navbar__links\">Friends</a></li>\r\n      <li class=\"navbar__item\"><a href=\"/profile\" data-link class=\"navbar__links\">Profile</a></li>\r\n      <li class=\"navbar__item\"><a href=\"#\" class=\"navbar__links sign-out-button\">Sign out</a></li>\r\n    `;\r\n    mobileMenu.innerHTML = `\r\n      <li class=\"mobile-menu__item\"><a href=\"/journal\" data-link class=\"mobile-menu__link\">Journal</a></li>\r\n      <li class=\"mobile-menu__item\"><a href=\"/profile\" data-link class=\"mobile-menu__link\">Profile</a></li>\r\n      <li class=\"mobile-menu__item\"><a href=\"/friends\" data-link class=\"mobile-menu__link\">Friends</a></li>\r\n      <li class=\"mobile-menu__item\"><a href=\"#\" id=\"sign-out-button\" class=\"mobile-menu__link sign-out-button\">Sign out</a></li>\r\n    `;\r\n  } else {\r\n    // If user is not signed in\r\n    navbarMenu.innerHTML = `\r\n      <li class=\"navbar__item\"><a href=\"/signin\" data-link class=\"navbar__links\">Sign In</a></li>\r\n      <li class=\"navbar__item\"><a href=\"/register\" data-link class=\"navbar__links\">Register</a></li>\r\n    `;\r\n    mobileMenu.innerHTML = `\r\n      <li class=\"mobile-menu__item\"><a href=\"/signin\" data-link class=\"mobile-menu__link\">Sign In</a></li>\r\n      <li class=\"mobile-menu__item\"><a href=\"/register\" data-link class=\"mobile-menu__link\">Register</a></li>\r\n    `;\r\n  }\r\n\r\n  const signOutButtons = document.querySelectorAll('.sign-out-button');\r\n  signOutButtons.forEach((button) => {\r\n    button.addEventListener('click', function (event) {\r\n      event.preventDefault(); // Prevent the default link behavior\r\n      signOut(auth)\r\n        .then(() => {\r\n          console.log('Signed out successfully');\r\n          window.location.href = '/signin';\r\n        })\r\n        .catch((error) => {\r\n          console.error('Error signing out:', error);\r\n        });\r\n    });\r\n  });\r\n}\r\nasync function setUserProfileContents() {\r\n  // Profile fields\r\n  const username = document.getElementById('username');\r\n  const avatar = document.getElementById('profileAvatar');\r\n  const labelLastOnline = document.getElementById('label-lastonline');\r\n  const labelJoined = document.getElementById('label-joined');\r\n\r\n  // Settings fields\r\n  const usernameField = document.getElementById('usernameInput');\r\n  const accentColor = document.getElementById('secondary-color');\r\n  const accentColorDark = document.getElementById('secondary-color-dark');\r\n\r\n  // Get current secondary color\r\n  function getRootVariable(variable) {\r\n    return getComputedStyle(document.documentElement).getPropertyValue(variable).trim();\r\n  }\r\n  const rootSecondaryColor = getRootVariable('--secondary-color');\r\n  const rootSecondaryColorDark = getRootVariable('--secondary-color-dark');\r\n\r\n  function setRootVariable(variable, value) {\r\n    document.documentElement.style.setProperty(variable, value);\r\n    localStorage.setItem(variable, value);\r\n  }\r\n\r\n  try {\r\n    // Reference to the \"users\" collection\r\n    const usersDoc = collection(db, 'users');\r\n    const usersSnapshot = await getDocs(usersDoc);\r\n\r\n    // Set userdata to profile or settings\r\n    usersSnapshot.forEach((doc) => {\r\n      const userData = doc.data();\r\n\r\n      // Get right user with email check\r\n      if (userData.email === getCurrentUser().email && getPath() === '/profile') {\r\n        // Set username, from db\r\n        username.textContent = userData.username;\r\n        // Set accent colors, from db\r\n        setRootVariable('--secondary-color', userData.accentColor);\r\n        setRootVariable('--secondary-color-dark', userData.accentColorDark);\r\n\r\n        // Set avatar / if no avatar set default, from db\r\n        avatar.src = userData.avatarURL;\r\n        avatar.onerror = function () {\r\n          avatar.src = 'https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png';\r\n        };\r\n        // lastonline\r\n        labelLastOnline.textContent = userData.lastOnlineDate + ' ' + userData.lastOnlineTime;\r\n        //joined\r\n        labelJoined.textContent = userData.joined ? userData.joined : 'unknown';\r\n      } else if (userData.email === getCurrentUser().email && getPath() === '/settings') {\r\n        // Set settings fields values\r\n        usernameField.value = userData.username;\r\n        accentColor.value = rootSecondaryColor;\r\n        accentColorDark.value = rootSecondaryColorDark;\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error('Error fetching user data:', error);\r\n  }\r\n}\r\nasync function setListViewContent() {\r\n  const listView = document.querySelector('.list-view');\r\n  listView.innerHTML =\r\n    ' <div class=\"list-header\">My Dream entries <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"30px\" viewBox=\"0 -960 960 960\" width=\"30px\" fill=\"#cbd5e0\"><path d=\"m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z\"/></svg></div> '; // Clear previous content and add header\r\n\r\n  try {\r\n    const documents = await getDocumentsByUserId('entries', 'userID', getCurrentUser().uid);\r\n    documents.forEach((doc) => {\r\n      const textContentShort = doc.text.substring(0, 20);\r\n      const listItem = document.createElement('div');\r\n      listItem.className = 'list-item';\r\n\r\n      listItem.innerHTML = `\r\n            <div class=\"list-item__content\">\r\n              <div class=\"list-item__title\" id=\"item-title\">\r\n                ${doc.title}\r\n                <div id=\"delete-icon-${doc.id}\">\r\n                  <svg class=\"list-item__icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"28px\" viewBox=\"0 -960 960 960\" width=\"28px\" fill=\"#cbd5e0\">\r\n                    <path d=\"M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z\" />\r\n                  </svg>\r\n                </div>\r\n                <div id=\"edit-icon-${doc.id}\">\r\n                  <svg class=\"list-item__icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"28px\" viewBox=\"0 -960 960 960\" width=\"28px\" fill=\"#cbd5e0\">\r\n                    <path d=\"M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z\" />\r\n                  </svg>\r\n                </div>\r\n              </div>\r\n              <div class=\"list-item__subtitle\" id=\"item-subtitle\">Date: ${doc.date}</div>\r\n            </div>\r\n      `;\r\n\r\n      listView.appendChild(listItem);\r\n\r\n      const editSvg = document.getElementById(`edit-icon-${doc.id}`);\r\n      const deleteSvg = document.getElementById(`delete-icon-${doc.id}`);\r\n\r\n      handleEditSvg(editSvg, doc);\r\n      handleDeleteSvg(deleteSvg, doc);\r\n    });\r\n  } catch (error) {\r\n    console.error('Error setting list view content:', error);\r\n  }\r\n}\r\nasync function getDocumentsByUserId(collectionName, neededVariable, variable) {\r\n  const documents = [];\r\n  try {\r\n    const q = query(collection(db, collectionName), where(neededVariable, '==', variable));\r\n    const querySnapshot = await getDocs(q);\r\n    querySnapshot.forEach((doc) => {\r\n      documents.push({ id: doc.id, ...doc.data() });\r\n    });\r\n  } catch (error) {\r\n    console.error('Error getting documents: ', error);\r\n  }\r\n  console.log(documents);\r\n  return documents;\r\n}\r\nasync function updateLastOnlineTimer() {\r\n  const date = new Date();\r\n  const day = String(date.getDate()).padStart(2, '0');\r\n  const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are 0-indexed\r\n  const year = date.getFullYear();\r\n\r\n  const hours = String(date.getHours()).padStart(2, '0');\r\n  const minutes = String(date.getMinutes()).padStart(2, '0');\r\n\r\n  const dateStr = `${day}-${month}-${year}`;\r\n  const timeStr = `${hours}:${minutes}`;\r\n\r\n  try {\r\n    const updatedData = {\r\n      lastOnlineDate: dateStr,\r\n      lastOnlineTime: timeStr\r\n    };\r\n\r\n    const docRef = doc(db, 'users', getCurrentUser().uid); // Reference to the specific document\r\n    await updateDoc(docRef, updatedData); // Perform the update\r\n    console.log('updated online status timer');\r\n  } catch (error) {\r\n    console.error('updateLastOnlineTimer: ' + error);\r\n  }\r\n}\r\nfunction loadSavedColorVariables() {\r\n  Object.keys(localStorage).forEach((key) => {\r\n    if (key.startsWith('--')) {\r\n      // Check if it's a CSS variable\r\n      const value = localStorage.getItem(key);\r\n      document.documentElement.style.setProperty(key, value);\r\n    }\r\n  });\r\n}\r\n// Friendlist\r\nfunction handleSearchBar() {\r\n  const searchBar = document.getElementById('search-bar');\r\n  const searchIcon = document.getElementById('search-icon');\r\n  const friendLV = document.getElementById('friendListView');\r\n  let friendsList = [];\r\n\r\n  const searchFriends = async () => {\r\n    friendLV.innerHTML = ''; // Clear previous\r\n    // Search by name\r\n    try {\r\n      const searchQuery = searchBar.value.trim().toLowerCase(); // Normalize query\r\n      console.log(`Searching for friends with token: ${searchQuery}`);\r\n\r\n      // Search through db for matching tokens\r\n      let foundUser = await getDocumentsByUserId('users', 'username', searchQuery);\r\n      foundUser.forEach((item) => {\r\n        console.log('gufhisjodpskls' + item);\r\n      });\r\n      if (foundUser.length > 0) {\r\n        foundUser.forEach((item) => {\r\n          const isFriend = friendsList.includes(item.id);\r\n          console.log('fromsearch');\r\n          setFoundUser(item, isFriend);\r\n        });\r\n      } else {\r\n        console.log('nothign found or no search made');\r\n        setDefaultFriends();\r\n      }\r\n    } catch (error) {\r\n      console.error('search error: ' + error);\r\n    }\r\n  };\r\n  const setFoundUser = (foundUser, isFriend) => {\r\n    if (!foundUser || !foundUser.id) {\r\n      console.error('Invalid foundUser:', foundUser);\r\n      return;\r\n    }\r\n\r\n    const userDiv = document.createElement('div');\r\n    userDiv.className = 'profile-container';\r\n\r\n    // Determine the SVG icon based on friendship status\r\n    const iconSVG = isFriend\r\n      ? `\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\" width=\"24px\" fill=\"#FFFFFF\"><path d=\"M640-520v-80h240v80H640Zm-280 40q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z\"/></svg>\r\n          `\r\n      : `\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\" width=\"24px\" fill=\"#FFFFFF\"><path d=\"M720-400v-120H600v-80h120v-120h80v120h120v80H800v120h-80Zm-360-80q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z\"/></svg>\r\n          `;\r\n\r\n    userDiv.innerHTML = `\r\n        <div class=\"container-icon\">\r\n          <img id=\"small-pfp\" src=\"${foundUser.avatarURL}\" style=\"user-select: none\" />\r\n        </div>\r\n        <h1>${foundUser.username}</h1>\r\n        <div class=\"container-buttons\">\r\n          <div class=\"container-button add\" id=\"container-button-${foundUser.id}\">\r\n            ${iconSVG}\r\n          </div>\r\n        </div>\r\n      `;\r\n    friendLV.appendChild(userDiv);\r\n\r\n    if (!isFriend) {\r\n      const addFriendIcon = document.getElementById(`container-button-${foundUser.id}`);\r\n      addFriendIcon.addEventListener('click', () => sendFriendRequest(getCurrentUser().uid, foundUser.id));\r\n    } else if (isFriend) {\r\n      const delFriendIcon = document.getElementById(`container-button-${foundUser.id}`);\r\n      delFriendIcon.addEventListener('click', () => deleteFriendship(getCurrentUser().uid, foundUser.id));\r\n    }\r\n  };\r\n\r\n  const setDefaultFriends = () => {\r\n    if (dbSearchFriends() === false) {\r\n      friendLV.innerHTML = `\r\n        <h1>No frens or frens request :< </h1>\r\n        `;\r\n    } else {\r\n      // show friends AND find friend requests\r\n      dbSearchFriendRequests();\r\n    }\r\n  };\r\n  const dbSearchFriendRequests = async () => {\r\n    const friendRequestList = [];\r\n\r\n    try {\r\n      //userId2 = someone sent you req\r\n      const q = query(\r\n        collection(db, 'friends'),\r\n        where('userId2', '==', getCurrentUser().uid),\r\n        where('status', '==', 'pending')\r\n      );\r\n      const querySnapshot = await getDocs(q);\r\n\r\n      querySnapshot.forEach((doc) => {\r\n        friendRequestList.push({ id: doc.id, ...doc.data() });\r\n      });\r\n\r\n      console.log(`you have ${friendRequestList.length} friend reqs`);\r\n      if (friendRequestList.length > 0) {\r\n        friendRequestList.forEach(async (item) => {\r\n          // Get user2 specific info to show in request\r\n          const userRef = doc(db, 'users', item.userId1);\r\n          const userDoc = await getDoc(userRef);\r\n          const userData = userDoc.data();\r\n\r\n          showFriendRequests(userData, item.id);\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('dbSearchFriendRequests' + error);\r\n    }\r\n  };\r\n  const dbSearchFriends = async () => {\r\n    const friends = [];\r\n    friendsList = [];\r\n\r\n    try {\r\n      // find accepted friend request where userId1 equals currentUser.uid\r\n      const q1 = query(\r\n        collection(db, 'friends'),\r\n        where('userId1', '==', getCurrentUser().uid),\r\n        where('status', '==', 'accepted')\r\n      );\r\n\r\n      // find accepted friend request where userId2 equals currentUser.uid\r\n      const q2 = query(\r\n        collection(db, 'friends'),\r\n        where('userId2', '==', getCurrentUser().uid),\r\n        where('status', '==', 'accepted')\r\n      );\r\n\r\n      // Execute both queries\r\n      const [querySnapshot1, querySnapshot2] = await Promise.all([getDocs(q1), getDocs(q2)]);\r\n\r\n      // Process the results from the first query\r\n      querySnapshot1.forEach((doc) => {\r\n        const data = doc.data();\r\n        const friendId = data.userId2; // since userId1 is currentUser.uid\r\n        friends.push({ id: doc.id, friendId });\r\n        friendsList.push(friendId); // Store friend user IDs\r\n      });\r\n\r\n      // Process the results from the second query\r\n      querySnapshot2.forEach((doc) => {\r\n        const data = doc.data();\r\n        const friendId = data.userId1; // since userId2 is currentUser.uid\r\n        friends.push({ id: doc.id, friendId });\r\n        friendsList.push(friendId); // Store friend user IDs\r\n      });\r\n      console.log(friendsList);\r\n\r\n      // Get friends details from users using id\r\n      const userPromises = friends.map(async (friend) => {\r\n        console.log();\r\n\r\n        const docRef = doc(db, 'users', friend.friendId);\r\n        const docSnap = await getDoc(docRef);\r\n        if (docSnap.exists()) {\r\n          const docSnapData = docSnap.data();\r\n          console.log('from dbsearch');\r\n          setFoundUser({ ...docSnapData, id: friend.friendId }, true);\r\n        }\r\n      });\r\n\r\n      await Promise.all(userPromises);\r\n\r\n      if (friends.length > 0) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    } catch (error) {\r\n      console.error('dbSearchFriends: ' + error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const showFriendRequests = async (friendInfo, friendRequestId) => {\r\n    try {\r\n      const userDiv = document.createElement('div');\r\n      userDiv.className = 'profile-container';\r\n\r\n      userDiv.innerHTML = `\r\n          <div class=\"container-icon\">\r\n            <img id=\"small-pfp\" src=\"${friendInfo.avatarURL}\" style=\"user-select: none\" />\r\n          </div>\r\n        <h1>${friendInfo.username}</h1>\r\n        <div class=\"container-buttons\">\r\n          <div class=\"container-button accept\" id=\"accept-${friendInfo.id}\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"40px\" viewBox=\"0 -960 960 960\" width=\"40px\" fill=\"#cbd5e1\"><path d=\"m424-296 282-282-56-56-226 226-114-114-56 56 170 170Zm56 216q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z\"/></svg>\r\n          </div>\r\n          <div class=\"container-button reject\" id=\"reject-${friendInfo.id}\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"40px\" viewBox=\"0 -960 960 960\" width=\"40px\" fill=\"#cbd5e1\"><path d=\"m336-280 144-144 144 144 56-56-144-144 144-144-56-56-144 144-144-144-56 56 144 144-144 144 56 56ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z\"/></svg>\r\n          </div>\r\n        </div>\r\n          `;\r\n      friendLV.appendChild(userDiv);\r\n      // Add event listeners for accept/reject\r\n      const acceptButton = document.getElementById(`accept-${friendInfo.id}`);\r\n      const rejectButton = document.getElementById(`reject-${friendInfo.id}`);\r\n      acceptButton.addEventListener('click', () => handleRequest(true, friendRequestId));\r\n      rejectButton.addEventListener('click', () => handleRequest(false, friendRequestId));\r\n    } catch (error) {\r\n      console.error('showFriendRequests ' + error);\r\n    }\r\n  };\r\n  const handleRequest = async (didUserAccept, friendRequestId) => {\r\n    console.log('friendRequestId: ' + friendRequestId);\r\n\r\n    const docRef = doc(db, 'friends', friendRequestId);\r\n    if (didUserAccept) {\r\n      const updatedData = {\r\n        status: 'accepted'\r\n      };\r\n      await updateDoc(docRef, updatedData);\r\n      console.log('req accepted');\r\n    } else if (!didUserAccept) {\r\n      const updatedData = {\r\n        status: 'declined'\r\n      };\r\n      await updateDoc(docRef, updatedData);\r\n      console.log('req declined');\r\n    }\r\n    // Default view\r\n\r\n    searchFriends();\r\n  };\r\n  const deleteFriendship = async (currentUserId, friendUserId) => {\r\n    console.log(`Trying to delete friendship between user1: ${currentUserId}, user2: ${friendUserId}`);\r\n\r\n    try {\r\n      // Query to find the friendship document\r\n      const q = query(\r\n        collection(db, 'friends'),\r\n        where('userId1', '==', currentUserId),\r\n        where('userId2', '==', friendUserId),\r\n        where('status', '==', 'accepted')\r\n      );\r\n\r\n      const querySnapshot = await getDocs(q);\r\n\r\n      // Deleting each matching document (there should ideally be only one)\r\n      querySnapshot.forEach(async (doc) => {\r\n        await deleteDoc(doc.ref);\r\n        console.log(`Friendship document with ID ${doc.id} deleted.`);\r\n      });\r\n\r\n      // Refresh the default friends list view\r\n      searchFriends();\r\n    } catch (error) {\r\n      console.error('Error deleting friendship:', error);\r\n    }\r\n  };\r\n  const sendFriendRequest = async (currentUserId, friendUserId) => {\r\n    console.log(`trying friend request with:user1: ${currentUserId}, user2: ${friendUserId}`);\r\n    const customDocId = generateCustomId();\r\n    const docRef = doc(db, 'friends', customDocId);\r\n\r\n    try {\r\n      const friendRequest = await setDoc(docRef, {\r\n        userId1: currentUserId,\r\n        userId2: friendUserId,\r\n        status: 'pending'\r\n      });\r\n      console.log('Friend request made:', customDocId);\r\n      Swal.fire({\r\n        title: 'Friend request made!',\r\n        text: 'hope they add you back :)',\r\n        icon: 'success',\r\n        confirmButtonText: 'yippii',\r\n        background: '#f9f9f9',\r\n        confirmButtonColor: '#3085d6',\r\n        buttonsStyling: true\r\n      });\r\n    } catch (error) {\r\n      console.error('Error sending friend request:', error);\r\n    }\r\n  };\r\n\r\n  searchFriends();\r\n  searchIcon.addEventListener('click', searchFriends);\r\n  searchBar.addEventListener('keydown', (event) => {\r\n    if (event.key === 'Enter') {\r\n      searchFriends(event);\r\n    }\r\n  });\r\n}\r\n\r\nfunction handleImageSelect() {\r\n  const imageInput = document.getElementById('image-input');\r\n  const labelProfilePicture = document.getElementById('labelProfilePicture');\r\n\r\n  imageInput.addEventListener('change', function (e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    try {\r\n      const file = imageInput.files[0];\r\n\r\n      if (file) {\r\n        // Create a FileReader to read the file\r\n        const reader = new FileReader();\r\n\r\n        // Define the onload callback to get the base64 string\r\n        reader.onload = (e) => {\r\n          // Create an image element to hold the original image\r\n          const img = new Image();\r\n\r\n          // Set the image src to the data URL read from the file\r\n          img.src = e.target.result;\r\n          // Create a canvas to draw the resized image\r\n          const canvas = document.createElement('canvas');\r\n          const ctx = canvas.getContext('2d');\r\n\r\n          // Set the canvas dimensions to 150x150\r\n          canvas.width = 150;\r\n          canvas.height = 150;\r\n\r\n          // Define the onload callback for the image\r\n          img.onload = () => {\r\n            // Draw the resized image on the canvas\r\n            ctx.drawImage(img, 0, 0, 150, 150);\r\n\r\n            // Get the Base64 string of the resized image\r\n            setBase64String(canvas.toDataURL('image/png'));\r\n\r\n            // Display the Base64 string\r\n            console.log('base64 in variable: ' + getBase64String().substring(0, 20) + '...');\r\n\r\n            labelProfilePicture.textContent = 'Profile Picture (Image Selected)';\r\n          };\r\n        };\r\n\r\n        // Read the file as a data URL\r\n        reader.readAsDataURL(file);\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  });\r\n}\r\n\r\nasync function saveChanges(event) {\r\n  event.preventDefault();\r\n  event.stopPropagation();\r\n\r\n  const popup = document.getElementById('my-popup');\r\n  const backdrop = document.getElementById('backdrop');\r\n\r\n  // Prepare for edit changes\r\n  const titleInput = document.getElementById('pop-titleInput');\r\n  const textInput = document.getElementById('pop-textInput');\r\n  const dreamCategory = document.getElementById('pop-dream-category');\r\n  const starCategory = document.getElementById('pop-star-category');\r\n\r\n  try {\r\n    const updatedData = {\r\n      title: titleInput.value,\r\n      text: textInput.value,\r\n      category: dreamCategory.value,\r\n      stars: starCategory.value\r\n    };\r\n\r\n    const docRef = doc(db, 'entries', getCurrentSelectedEntry().id); // Reference to the specific document\r\n    await updateDoc(docRef, updatedData); // Perform the update\r\n    console.log('Document updated successfully:', getCurrentSelectedEntry().id);\r\n\r\n    popup.style.display = 'none';\r\n    backdrop.style.display = 'none';\r\n    // Refresh listview\r\n    setListViewContent();\r\n  } catch (error) {\r\n    console.error('Error updating Firestore document:', error);\r\n  }\r\n}\r\n\r\n// Handle Functions\r\nfunction handleEditSvg(editButton, itemInfo) {\r\n  const popup = document.getElementById('my-popup');\r\n  const backgroundBlur = document.getElementById('backdrop'); // add cool blur\r\n\r\n  const titleInput = document.getElementById('pop-titleInput');\r\n  const textInput = document.getElementById('pop-textInput');\r\n  const dreamCategory = document.getElementById('pop-dream-category');\r\n  const starCategory = document.getElementById('pop-star-category');\r\n\r\n  // Function to toggle the popup visibility\r\n  const togglePopup = (event) => {\r\n    event.stopPropagation(); // Prevent click event from bubbling up\r\n\r\n    // Set iteminfo to inputs\r\n    titleInput.value = itemInfo.title;\r\n    textInput.value = itemInfo.text;\r\n    dreamCategory.value = itemInfo.category;\r\n    starCategory.value = itemInfo.stars;\r\n\r\n    // Display Toggle\r\n    popup.style.display = popup.style.display === 'flex' ? 'none' : 'flex';\r\n    backgroundBlur.style.display = backgroundBlur.style.display === 'block' ? 'none' : 'block';\r\n\r\n    setCurrentSelectedEntry(itemInfo);\r\n    console.log(itemInfo.id);\r\n  };\r\n\r\n  // Function to hide the popup\r\n  const hidePopup = (event) => {\r\n    if (!popup.contains(event.target) && !editButton.contains(event.target)) {\r\n      popup.style.display = 'none';\r\n      backgroundBlur.style.display = 'none';\r\n    }\r\n  };\r\n\r\n  editButton.addEventListener('click', togglePopup); // Event listener for the icon click\r\n  document.addEventListener('click', hidePopup); // Event listener for clicks outside the popup\r\n}\r\n\r\nasync function handleDeleteSvg(button, itemInfo) {\r\n  const deleteItem = (event) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Ask if user wants to delete\r\n    Swal.fire({\r\n      title: 'Are you sure?',\r\n      text: 'You will not be able to recover this imaginary file!',\r\n      icon: 'error',\r\n      showCancelButton: true,\r\n      confirmButtonText: 'Yes, delete it!',\r\n      cancelButtonText: 'No, keep it'\r\n    }).then(async (result) => {\r\n      // User clicked \"Yes, delete it!\"\r\n      if (result.isConfirmed) {\r\n        await deleteDoc(doc(db, 'entries', itemInfo.id));\r\n        console.log('refresh list');\r\n\r\n        await setListViewContent(); // update listview\r\n      }\r\n    });\r\n  };\r\n  button.addEventListener('click', deleteItem);\r\n}\r\n\r\nfunction handleSettingsSaveButton(button) {\r\n  button.addEventListener('click', async function (event) {\r\n    event.preventDefault();\r\n\r\n    const usernameField = document.getElementById('usernameInput').value;\r\n    const accentColor = document.getElementById('secondary-color').value;\r\n    const accentColorDark = document.getElementById('secondary-color-dark').value;\r\n\r\n    try {\r\n      const userRef = doc(db, 'users', getCurrentUser().uid);\r\n\r\n      // Fetch current user data\r\n      const userDoc = await getDoc(userRef);\r\n      const userData = userDoc.data();\r\n\r\n      // Prepare update object\r\n      const updateData = {\r\n        username: usernameField,\r\n        accentColor: accentColor,\r\n        accentColorDark: accentColorDark\r\n      };\r\n\r\n      // Only update avatarURL if a new image has been selected\r\n      if (getBase64String()) {\r\n        console.log('base64 added to updatedData: ' + getBase64String().substring(0, 20) + '...');\r\n        updateData.avatarURL = getBase64String();\r\n      }\r\n\r\n      await updateDoc(userRef, updateData);\r\n      window.location.href = '/profile';\r\n    } catch (error) {\r\n      console.error('db update error: ' + error);\r\n    }\r\n  });\r\n}\r\n\r\nfunction handleLoginButton(button) {\r\n  button.addEventListener('click', function (event) {\r\n    event.preventDefault();\r\n\r\n    const email = document.getElementById('emailField').value;\r\n    const password = document.getElementById('passwordField').value;\r\n\r\n    signInWithEmailAndPassword(auth, email, password)\r\n      .then(async (userCredential) => {\r\n        console.log('User signed in:', userCredential.user);\r\n        window.location.href = '/profile';\r\n        console.log('navigate to profile');\r\n      })\r\n      .catch((error) => {\r\n        console.error('Error:', error);\r\n        Swal.fire({\r\n          title: 'Error signing in!',\r\n          text: `${error.message}, check details!`,\r\n          icon: 'error',\r\n          confirmButtonText: 'Ok',\r\n          background: '#f9f9f9',\r\n          confirmButtonColor: '#3085d6',\r\n          buttonsStyling: true\r\n        });\r\n      });\r\n  });\r\n}\r\n\r\nfunction createSearchTokens(username) {\r\n  const tokens = [];\r\n  const lowerCaseUsername = username.toLowerCase();\r\n  const words = lowerCaseUsername.split(' ');\r\n\r\n  words.forEach((word) => {\r\n    let partial = '';\r\n    for (let char of word) {\r\n      partial += char;\r\n      tokens.push(partial);\r\n    }\r\n  });\r\n\r\n  return tokens;\r\n}\r\nfunction getCurrentDate() {\r\n  const date = new Date();\r\n  const day = String(date.getDate()).padStart(2, '0');\r\n  const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are 0-indexed\r\n  const year = date.getFullYear();\r\n  const dateStr = `${day}-${month}-${year}`;\r\n  return dateStr;\r\n}\r\n\r\nfunction handleRegisterButton(button) {\r\n  button.addEventListener('click', function (event) {\r\n    event.preventDefault();\r\n    const emailValue = document.getElementById('emailField').value;\r\n    const usernameValue = document.getElementById('usernameField').value;\r\n    const password = document.getElementById('passwordField').value;\r\n    const passwordCheck = document.getElementById('passwordCheckField').value;\r\n    const passwordCheckResult = validateForm(emailValue, usernameValue, password, passwordCheck);\r\n\r\n    if (passwordCheckResult === 'Valid password.') {\r\n      // Create tokens for username for easy search in friends tab\r\n      const searchTokens = createSearchTokens(usernameValue);\r\n\r\n      // Register user to db\r\n      createUserWithEmailAndPassword(auth, emailValue, password)\r\n        .then(async (userCredential) => {\r\n          const user = userCredential.user;\r\n          const joinedDate = getCurrentDate();\r\n          await setDoc(doc(db, 'users', user.uid), {\r\n            avatarURL: 'https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png',\r\n            email: emailValue,\r\n            username: usernameValue,\r\n            searchTokens: searchTokens,\r\n            accentColor: '#e869bd',\r\n            accentColorDark: '#6f0166',\r\n            joined: joinedDate\r\n          });\r\n          window.location.href = '/profile';\r\n        })\r\n        .catch((error) => {\r\n          Swal.fire({\r\n            title: 'Error registering!',\r\n            text: `${error.message}, check details!, ${passwordCheckResult}`,\r\n            icon: 'error',\r\n            confirmButtonText: 'Ok',\r\n            background: '#f9f9f9',\r\n            confirmButtonColor: '#3085d6',\r\n            buttonsStyling: true\r\n          });\r\n        });\r\n    } else {\r\n      Swal.fire({\r\n        title: 'Error!',\r\n        text: passwordCheckResult,\r\n        icon: 'error',\r\n        confirmButtonText: 'Ok',\r\n        background: '#f9f9f9',\r\n        confirmButtonColor: '#3085d6',\r\n        buttonsStyling: true\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nfunction handleSaveButton(button) {\r\n  console.log('save button found: ' + button);\r\n\r\n  button.addEventListener('click', async function (event) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    console.log('clicked save button');\r\n\r\n    const journalEntry = JournalEntry.journalMain();\r\n    const customDocId = generateCustomId();\r\n    const docRef = doc(db, 'entries', customDocId);\r\n\r\n    try {\r\n      await setDoc(docRef, journalEntry.toFirestore());\r\n      console.log('Document written with ID: ', customDocId);\r\n      //update Listview\r\n      setListViewContent();\r\n    } catch (error) {\r\n      console.error('Error adding document: ', error);\r\n    }\r\n  });\r\n}\r\n\r\nfunction validateForm(emailValue, usernameValue, password, passwordCheck) {\r\n  if (password === '' || passwordCheck === '' || emailValue === '' || usernameValue === '') {\r\n    return 'Inputfields cannot be empty.';\r\n  } else if (password !== passwordCheck) {\r\n    return 'Passwords do not match.';\r\n  } else {\r\n    return 'Valid password.';\r\n  }\r\n}\r\n\r\n// Journal class\r\nclass JournalEntry {\r\n  constructor(title, text, stars, category, date, userID) {\r\n    this.title = title;\r\n    this.text = text;\r\n    this.stars = stars;\r\n    this.category = category;\r\n    this.date = date;\r\n    this.userID = userID;\r\n  }\r\n\r\n  static journalMain() {\r\n    //read values\r\n    var titleValue = document.getElementById('titleInput').value;\r\n    var textValue = document.getElementById('textInput').value;\r\n\r\n    if (titleValue === '') {\r\n      titleValue = 'untitled';\r\n    }\r\n    if (textValue === '') {\r\n      textValue = '-';\r\n    }\r\n\r\n    const starCategory = document.getElementById('star-category');\r\n    const selectedStarValue = starCategory && starCategory.value !== '' ? starCategory.value : 'unrated';\r\n    console.log(selectedStarValue);\r\n\r\n    const categorySelect = document.getElementById('dream-category');\r\n    const categoryValue = categorySelect && categorySelect.value !== '' ? categorySelect.value : 'none';\r\n    console.log(categoryValue);\r\n\r\n    const now = new Date();\r\n    const year = now.getFullYear();\r\n    const month = String(now.getMonth() + 1).padStart(2, '0'); // Months are 0-based\r\n    const day = String(now.getDate()).padStart(2, '0');\r\n\r\n    const dateValue = `${day}-${month}-${year}`;\r\n    const userIDValue = getCurrentUser().uid;\r\n\r\n    return new JournalEntry(titleValue, textValue, selectedStarValue, categoryValue, dateValue, userIDValue);\r\n  }\r\n\r\n  toFirestore() {\r\n    return {\r\n      title: this.title,\r\n      text: this.text,\r\n      stars: this.stars,\r\n      category: this.category,\r\n      date: this.date,\r\n      userID: this.userID\r\n    };\r\n  }\r\n}\r\n\r\nfunction generateCustomId() {\r\n  const date = new Date();\r\n  const day = String(date.getDate()).padStart(2, '0');\r\n  const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are 0-indexed\r\n  const year = date.getFullYear();\r\n\r\n  const dateStr = `${year}${month}${day}`;\r\n  const uniquePart = nanoid(10); // Generate a 10-character nanoid\r\n  return `${dateStr}_${uniquePart}`;\r\n}\r\n\r\nexport {\r\n  setNavbarContent,\r\n  setUserProfileContents,\r\n  setListViewContent,\r\n  getDocumentsByUserId,\r\n  updateLastOnlineTimer,\r\n  loadSavedColorVariables,\r\n  handleSearchBar,\r\n  handleImageSelect,\r\n  saveChanges,\r\n  handleEditSvg,\r\n  handleDeleteSvg,\r\n  handleSettingsSaveButton,\r\n  handleLoginButton,\r\n  handleRegisterButton,\r\n  handleSaveButton,\r\n  JournalEntry,\r\n  generateCustomId\r\n};\r\n","//public/main.js\r\nconsole.log('main.js loaded');\r\n\r\nimport { app } from '../src/firebase/firebase-config.js';\r\n\r\nimport { db } from '../src/firebase/firestore.js';\r\nimport {\r\n  getFirestore,\r\n  doc,\r\n  updateDoc,\r\n  collection,\r\n  getDocs,\r\n  addDoc,\r\n  deleteDoc,\r\n  query,\r\n  where,\r\n  getDoc,\r\n  setDoc\r\n} from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';\r\n\r\nimport { auth } from '../src/firebase/auth.js';\r\nimport {\r\n  getAuth,\r\n  signInWithEmailAndPassword,\r\n  onAuthStateChanged,\r\n  createUserWithEmailAndPassword,\r\n  signOut\r\n} from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';\r\n\r\nimport {\r\n  setNavbarContent,\r\n  setUserProfileContents,\r\n  setListViewContent,\r\n  getDocumentsByUserId,\r\n  updateLastOnlineTimer,\r\n  loadSavedColorVariables,\r\n  handleSearchBar,\r\n  handleImageSelect,\r\n  saveChanges,\r\n  handleEditSvg,\r\n  handleDeleteSvg,\r\n  handleSettingsSaveButton,\r\n  handleLoginButton,\r\n  handleRegisterButton,\r\n  handleSaveButton,\r\n  JournalEntry,\r\n  generateCustomId\r\n} from '../src/utils/helpers.js';\r\nimport {\r\n  setCurrentUser,\r\n  setCurrentSelectedEntry,\r\n  setBase64String,\r\n  setPath,\r\n  getCurrentUser,\r\n  getCurrentSelectedEntry,\r\n  getBase64String,\r\n  getPath\r\n} from './state.js';\r\n\r\ndocument.addEventListener('DOMContentLoaded', function (event) {\r\n  loadSavedColorVariables();\r\n\r\n  console.log('DOM loaded');\r\n});\r\n\r\nexport async function initializePage(pathName) {\r\n  setPath(pathName);\r\n\r\n  const saveButton = document.getElementById('button-save');\r\n  const loginButton = document.getElementById('button-signin');\r\n  const registerButton = document.getElementById('button-register');\r\n  const settingsSaveButton = document.getElementById('button-settings-save');\r\n  const saveChangesButton = document.getElementById('pop-button-save');\r\n\r\n  // Set up auth state listener\r\n  await onAuthStateChanged(auth, (user) => {\r\n    // Functions that launch after page refresh or auth state change\r\n    console.log('currentUser set');\r\n    setCurrentUser(user);\r\n\r\n    setNavbarContent();\r\n\r\n    if (getCurrentUser()) {\r\n      updateLastOnlineTimer();\r\n      if (getPath() === '/settings' || getPath() === '/profile') {\r\n        setUserProfileContents();\r\n      }\r\n      console.log(`User is signed in with UID: ${getCurrentUser().uid}`);\r\n    } else {\r\n      console.log('User is signed out');\r\n    }\r\n    // Execute page-specific actions\r\n    if (getPath() === '/journal') {\r\n      console.log('trying to set list view content');\r\n      setListViewContent();\r\n      console.log('handle save button');\r\n      handleSaveButton(saveButton);\r\n      saveChangesButton.addEventListener('click', saveChanges);\r\n    } else if (getPath() === '/settings') {\r\n      console.log('handle settings save button');\r\n\r\n      handleSettingsSaveButton(settingsSaveButton);\r\n      handleImageSelect();\r\n    } else if (getPath() === '/signin') {\r\n      if (loginButton) {\r\n        handleLoginButton(loginButton);\r\n        console.log('login button found!');\r\n      } else {\r\n        console.log('login button NOT found!');\r\n      }\r\n    } else if (getPath() === '/register') {\r\n      console.log('register button found!');\r\n\r\n      handleRegisterButton(registerButton);\r\n    } else if (getPath() === '/friends') {\r\n      console.log('friends button found!');\r\n\r\n      handleSearchBar();\r\n    }\r\n  });\r\n}\r\n","// public/router.js\r\nconsole.log('router.js loaded');\r\n\r\nimport { initializePage } from './main.js';\r\n\r\nconst routes = {\r\n  404: { title: '404', template: 'templates/404.html' },\r\n  '/': { title: 'Home', template: 'templates/default.html' },\r\n  '/journal': { title: 'Journal', template: 'templates/journal.html' },\r\n  '/signin': { title: 'Sign In', template: 'templates/signin.html' },\r\n  '/profile': { title: 'Profile', template: 'templates/profile.html' },\r\n  '/settings': { title: 'Settings', template: 'templates/settings.html' },\r\n  '/friends': { title: 'Friends', template: 'templates/friends.html' },\r\n  '/register': { title: 'Register', template: 'templates/register.html' }\r\n};\r\n\r\nconst route = (event) => {\r\n  event = event || window.event;\r\n  event.preventDefault();\r\n  window.history.pushState({}, '', event.target.href);\r\n  handleLocation();\r\n};\r\n\r\nconst handleLocation = async () => {\r\n  console.log('---------------SWITCHING PATH --------------');\r\n\r\n  const path = window.location.pathname;\r\n  const route = routes[path] || routes[404];\r\n  try {\r\n    const response = await fetch(`templates/${route.template.split('/').pop()}`);\r\n    if (!response.ok) {\r\n      console.error(`HTTP error! status: ${response.status}`);\r\n    }\r\n    const html = await response.text();\r\n    document.getElementById('content').innerHTML = html;\r\n\r\n    document.title = route.title;\r\n    console.log('html loaded successfully');\r\n    console.log('path is ' + path);\r\n\r\n    initializePage(path);\r\n  } catch (error) {\r\n    console.error('Error loading template:', error);\r\n    // Handle the error appropriately\r\n  }\r\n};\r\n\r\nwindow.onpopstate = handleLocation;\r\nwindow.route = route;\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  document.body.addEventListener('click', (e) => {\r\n    if (e.target.matches('[data-link]')) {\r\n      e.preventDefault();\r\n      route(e);\r\n    }\r\n  });\r\n\r\n  handleLocation();\r\n});\r\n\r\nconst getCurrentRoute = () => {\r\n  const path = window.location.pathname;\r\n  return routes[path] || routes[404];\r\n};\r\n\r\nwindow.getCurrentRoute = getCurrentRoute;\r\n"],"names":["firebaseConfig","app","initializeApp","db","getFirestore","auth","getAuth","currentUser","currentSelectedEntry","base64String","path","setCurrentUser","user","setCurrentSelectedEntry","entry","setBase64String","base64Str","setPath","newPath","getCurrentUser","getCurrentSelectedEntry","getBase64String","getPath","setNavbarContent","navbarMenu","mobileMenu","button","event","signOut","error","setUserProfileContents","username","avatar","labelLastOnline","labelJoined","usernameField","accentColor","accentColorDark","getRootVariable","variable","rootSecondaryColor","rootSecondaryColorDark","setRootVariable","value","usersDoc","collection","getDocs","doc","userData","setListViewContent","listView","getDocumentsByUserId","textContentShort","listItem","editSvg","deleteSvg","handleEditSvg","handleDeleteSvg","collectionName","neededVariable","documents","q","query","where","updateLastOnlineTimer","date","day","month","year","hours","minutes","dateStr","timeStr","updatedData","docRef","updateDoc","loadSavedColorVariables","key","handleSearchBar","searchBar","searchIcon","friendLV","friendsList","searchFriends","searchQuery","foundUser","item","isFriend","setFoundUser","setDefaultFriends","userDiv","iconSVG","deleteFriendship","sendFriendRequest","dbSearchFriends","dbSearchFriendRequests","friendRequestList","userRef","getDoc","showFriendRequests","friends","q1","q2","querySnapshot1","querySnapshot2","friendId","userPromises","friend","docSnap","docSnapData","friendInfo","friendRequestId","acceptButton","rejectButton","handleRequest","didUserAccept","currentUserId","friendUserId","deleteDoc","customDocId","generateCustomId","friendRequest","setDoc","handleImageSelect","imageInput","labelProfilePicture","e","file","reader","img","canvas","ctx","saveChanges","popup","backdrop","titleInput","textInput","dreamCategory","starCategory","editButton","itemInfo","backgroundBlur","togglePopup","hidePopup","deleteItem","result","handleSettingsSaveButton","updateData","handleLoginButton","email","password","signInWithEmailAndPassword","userCredential","createSearchTokens","tokens","word","partial","char","getCurrentDate","handleRegisterButton","emailValue","usernameValue","passwordCheck","passwordCheckResult","validateForm","searchTokens","createUserWithEmailAndPassword","joinedDate","handleSaveButton","journalEntry","JournalEntry","title","text","stars","category","userID","titleValue","textValue","selectedStarValue","categorySelect","categoryValue","now","dateValue","userIDValue","uniquePart","nanoid","initializePage","pathName","saveButton","loginButton","registerButton","settingsSaveButton","saveChangesButton","onAuthStateChanged","routes","route","handleLocation","response","html","getCurrentRoute"],"mappings":"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"}