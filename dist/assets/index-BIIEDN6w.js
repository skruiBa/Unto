import{initializeApp as z}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";import{getFirestore as K,collection as B,getDocs as T,query as k,where as b,doc as q,updateDoc as D,getDoc as $,setDoc as P,deleteDoc as O}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";import{getAuth as Q,signOut as X,signInWithEmailAndPassword as ee,createUserWithEmailAndPassword as te,onAuthStateChanged as ne}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";import{nanoid as oe}from"https://cdnjs.cloudflare.com/ajax/libs/nanoid/5.0.7/index.browser.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();const se={apiKey:"AIzaSyBiscdF0tuWqOHERdRQdNlkvbQsmClDLbo",authDomain:"dreamlog-7dff3.firebaseapp.com",databaseURL:"https://dreamlog-7dff3-default-rtdb.europe-west1.firebasedatabase.app",projectId:"dreamlog-7dff3",storageBucket:"dreamlog-7dff3.appspot.com",messagingSenderId:"5989316723",appId:"1:5989316723:web:72539d64015f7a5f8cd206",measurementId:"G-F1V81KG437"},j=z(se),g=K(j),_=Q(j);let V=null,N=null,A=null,U=null;function ae(e){V=e}function re(e){N=e}function ie(e){A=e}function le(e){U=e}function p(){return V}function H(){return N}function x(){return A}function E(){return U}console.log("helpers.js loaded");function ce(){const e=document.getElementById("navbar-menu"),o=document.getElementById("mobile-menu");console.log("trying to set navbar content"),p()?(e.innerHTML=`
      <li class="navbar__item"><a href="/journal" data-link class="navbar__links">Journal</a></li>
      <li class="navbar__item"><a href="/friends" data-link class="navbar__links">Friends</a></li>
      <li class="navbar__item"><a href="/profile" data-link class="navbar__links">Profile</a></li>
      <li class="navbar__item"><a href="#" class="navbar__links sign-out-button">Sign out</a></li>
    `,o.innerHTML=`
      <li class="mobile-menu__item"><a href="/journal" data-link class="mobile-menu__link">Journal</a></li>
      <li class="mobile-menu__item"><a href="/profile" data-link class="mobile-menu__link">Profile</a></li>
      <li class="mobile-menu__item"><a href="/friends" data-link class="mobile-menu__link">Friends</a></li>
      <li class="mobile-menu__item"><a href="#" id="sign-out-button" class="mobile-menu__link sign-out-button">Sign out</a></li>
    `):(e.innerHTML=`
      <li class="navbar__item"><a href="/signin" data-link class="navbar__links">Sign In</a></li>
      <li class="navbar__item"><a href="/register" data-link class="navbar__links">Register</a></li>
    `,o.innerHTML=`
      <li class="mobile-menu__item"><a href="/signin" data-link class="mobile-menu__link">Sign In</a></li>
      <li class="mobile-menu__item"><a href="/register" data-link class="mobile-menu__link">Register</a></li>
    `),document.querySelectorAll(".sign-out-button").forEach(s=>{s.addEventListener("click",function(n){n.preventDefault(),X(_).then(()=>{console.log("Signed out successfully"),window.location.href="/signin"}).catch(a=>{console.error("Error signing out:",a)})})})}async function de(){const e=document.getElementById("username"),o=document.getElementById("profileAvatar"),t=document.getElementById("label-lastonline"),s=document.getElementById("label-joined"),n=document.getElementById("usernameInput"),a=document.getElementById("secondary-color"),l=document.getElementById("secondary-color-dark");function d(y){return getComputedStyle(document.documentElement).getPropertyValue(y).trim()}const u=d("--secondary-color"),v=d("--secondary-color-dark");function h(y,S){document.documentElement.style.setProperty(y,S),localStorage.setItem(y,S)}try{const y=B(g,"users");(await T(y)).forEach(r=>{const i=r.data();i.email===p().email&&E()==="/profile"?(e.textContent=i.username,h("--secondary-color",i.accentColor),h("--secondary-color-dark",i.accentColorDark),o.src=i.avatarURL,o.onerror=function(){o.src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png"},t.textContent=i.lastOnlineDate+" "+i.lastOnlineTime,s.textContent=i.joined?i.joined:"unknown"):i.email===p().email&&E()==="/settings"&&(n.value=i.username,a.value=u,l.value=v)})}catch(y){console.error("Error fetching user data:",y)}}async function C(){const e=document.querySelector(".list-view");e.innerHTML=' <div class="list-header">My Dream entries <svg xmlns="http://www.w3.org/2000/svg" height="30px" viewBox="0 -960 960 960" width="30px" fill="#cbd5e0"><path d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"/></svg></div> ';try{(await Y("entries","userID",p().uid)).forEach(t=>{const s=t.text.substring(0,20),n=document.createElement("div");n.className="list-item",n.innerHTML=`
            <div class="list-item__content">
              <div class="list-item__title" id="item-title">
                ${t.title}
                <div id="delete-icon-${t.id}">
                  <svg class="list-item__icon" xmlns="http://www.w3.org/2000/svg" height="28px" viewBox="0 -960 960 960" width="28px" fill="#cbd5e0">
                    <path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z" />
                  </svg>
                </div>
                <div id="edit-icon-${t.id}">
                  <svg class="list-item__icon" xmlns="http://www.w3.org/2000/svg" height="28px" viewBox="0 -960 960 960" width="28px" fill="#cbd5e0">
                    <path d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z" />
                  </svg>
                </div>
              </div>
              <div class="list-item__subtitle" id="item-subtitle">Date: ${t.date}</div>
            </div>
      `,e.appendChild(n);const a=document.getElementById(`edit-icon-${t.id}`),l=document.getElementById(`delete-icon-${t.id}`);fe(a,t),ye(l,t)})}catch(o){console.error("Error setting list view content:",o)}}async function Y(e,o,t){const s=[];try{const n=k(B(g,e),b(o,"==",t));(await T(n)).forEach(l=>{s.push({id:l.id,...l.data()})})}catch(n){console.error("Error getting documents: ",n)}return console.log(s),s}async function ue(){const e=new Date,o=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0"),s=e.getFullYear(),n=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),l=`${o}-${t}-${s}`,d=`${n}:${a}`;try{const u={lastOnlineDate:l,lastOnlineTime:d},v=q(g,"users",p().uid);await D(v,u),console.log("updated online status timer")}catch(u){console.error("updateLastOnlineTimer: "+u)}}function me(){Object.keys(localStorage).forEach(e=>{if(e.startsWith("--")){const o=localStorage.getItem(e);document.documentElement.style.setProperty(e,o)}})}function ge(){const e=document.getElementById("search-bar"),o=document.getElementById("search-icon"),t=document.getElementById("friendListView");let s=[];const n=async()=>{t.innerHTML="";try{const r=e.value.trim().toLowerCase();console.log(`Searching for friends with token: ${r}`);let i=await Y("users","username",r);i.forEach(c=>{console.log("gufhisjodpskls"+c)}),i.length>0?i.forEach(c=>{const m=s.includes(c.id);console.log("fromsearch"),a(c,m)}):(console.log("nothign found or no search made"),l())}catch(r){console.error("search error: "+r)}},a=(r,i)=>{if(!r||!r.id){console.error("Invalid foundUser:",r);return}const c=document.createElement("div");c.className="profile-container";const m=i?`
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#FFFFFF"><path d="M640-520v-80h240v80H640Zm-280 40q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z"/></svg>
          `:`
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#FFFFFF"><path d="M720-400v-120H600v-80h120v-120h80v120h120v80H800v120h-80Zm-360-80q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z"/></svg>
          `;c.innerHTML=`
        <div class="container-icon">
          <img id="small-pfp" src="${r.avatarURL}" style="user-select: none" />
        </div>
        <h1>${r.username}</h1>
        <div class="container-buttons">
          <div class="container-button add" id="container-button-${r.id}">
            ${m}
          </div>
        </div>
      `,t.appendChild(c),i?i&&document.getElementById(`container-button-${r.id}`).addEventListener("click",()=>y(p().uid,r.id)):document.getElementById(`container-button-${r.id}`).addEventListener("click",()=>S(p().uid,r.id))},l=()=>{u()===!1?t.innerHTML=`
        <h1>No frens or frens request :< </h1>
        `:d()},d=async()=>{const r=[];try{const i=k(B(g,"friends"),b("userId2","==",p().uid),b("status","==","pending"));(await T(i)).forEach(m=>{r.push({id:m.id,...m.data()})}),console.log(`you have ${r.length} friend reqs`),r.length>0&&r.forEach(async m=>{const f=q(g,"users",m.userId1),w=(await $(f)).data();v(w,m.id)})}catch(i){console.error("dbSearchFriendRequests"+i)}},u=async()=>{const r=[];s=[];try{const i=k(B(g,"friends"),b("userId1","==",p().uid),b("status","==","accepted")),c=k(B(g,"friends"),b("userId2","==",p().uid),b("status","==","accepted")),[m,f]=await Promise.all([T(i),T(c)]);m.forEach(w=>{const I=w.data().userId2;r.push({id:w.id,friendId:I}),s.push(I)}),f.forEach(w=>{const I=w.data().userId1;r.push({id:w.id,friendId:I}),s.push(I)}),console.log(s);const M=r.map(async w=>{console.log();const F=q(g,"users",w.friendId),I=await $(F);if(I.exists()){const J=I.data();console.log("from dbsearch"),a({...J,id:w.friendId},!0)}});return await Promise.all(M),r.length>0}catch(i){return console.error("dbSearchFriends: "+i),!1}},v=async(r,i)=>{try{const c=document.createElement("div");c.className="profile-container",c.innerHTML=`
          <div class="container-icon">
            <img id="small-pfp" src="${r.avatarURL}" style="user-select: none" />
          </div>
        <h1>${r.username}</h1>
        <div class="container-buttons">
          <div class="container-button accept" id="accept-${r.id}">
            <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#cbd5e1"><path d="m424-296 282-282-56-56-226 226-114-114-56 56 170 170Zm56 216q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>
          </div>
          <div class="container-button reject" id="reject-${r.id}">
            <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#cbd5e1"><path d="m336-280 144-144 144 144 56-56-144-144 144-144-56-56-144 144-144-144-56 56 144 144-144 144 56 56ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>
          </div>
        </div>
          `,t.appendChild(c);const m=document.getElementById(`accept-${r.id}`),f=document.getElementById(`reject-${r.id}`);m.addEventListener("click",()=>h(!0,i)),f.addEventListener("click",()=>h(!1,i))}catch(c){console.error("showFriendRequests "+c)}},h=async(r,i)=>{console.log("friendRequestId: "+i);const c=q(g,"friends",i);r?(await D(c,{status:"accepted"}),console.log("req accepted")):r||(await D(c,{status:"declined"}),console.log("req declined")),n()},y=async(r,i)=>{console.log(`Trying to delete friendship between user1: ${r}, user2: ${i}`);try{const c=k(B(g,"friends"),b("userId1","==",r),b("userId2","==",i),b("status","==","accepted"));(await T(c)).forEach(async f=>{await O(f.ref),console.log(`Friendship document with ID ${f.id} deleted.`)}),n()}catch(c){console.error("Error deleting friendship:",c)}},S=async(r,i)=>{console.log(`trying friend request with:user1: ${r}, user2: ${i}`);const c=W(),m=q(g,"friends",c);try{const f=await P(m,{userId1:r,userId2:i,status:"pending"});console.log("Friend request made:",c),Swal.fire({title:"Friend request made!",text:"hope they add you back :)",icon:"success",confirmButtonText:"yippii",background:"#f9f9f9",confirmButtonColor:"#3085d6",buttonsStyling:!0})}catch(f){console.error("Error sending friend request:",f)}};n(),o.addEventListener("click",n),e.addEventListener("keydown",r=>{r.key==="Enter"&&n()})}function pe(){const e=document.getElementById("image-input"),o=document.getElementById("labelProfilePicture");e.addEventListener("change",function(t){t.preventDefault(),t.stopPropagation();try{const s=e.files[0];if(s){const n=new FileReader;n.onload=a=>{const l=new Image;l.src=a.target.result;const d=document.createElement("canvas"),u=d.getContext("2d");d.width=150,d.height=150,l.onload=()=>{u.drawImage(l,0,0,150,150),ie(d.toDataURL("image/png")),console.log("base64 in variable: "+x().substring(0,20)+"..."),o.textContent="Profile Picture (Image Selected)"}},n.readAsDataURL(s)}}catch(s){console.error(s)}})}async function he(e){e.preventDefault(),e.stopPropagation();const o=document.getElementById("my-popup"),t=document.getElementById("backdrop"),s=document.getElementById("pop-titleInput"),n=document.getElementById("pop-textInput"),a=document.getElementById("pop-dream-category"),l=document.getElementById("pop-star-category");try{const d={title:s.value,text:n.value,category:a.value,stars:l.value},u=q(g,"entries",H().id);await D(u,d),console.log("Document updated successfully:",H().id),o.style.display="none",t.style.display="none",C()}catch(d){console.error("Error updating Firestore document:",d)}}function fe(e,o){const t=document.getElementById("my-popup"),s=document.getElementById("backdrop"),n=document.getElementById("pop-titleInput"),a=document.getElementById("pop-textInput"),l=document.getElementById("pop-dream-category"),d=document.getElementById("pop-star-category"),u=h=>{h.stopPropagation(),n.value=o.title,a.value=o.text,l.value=o.category,d.value=o.stars,t.style.display=t.style.display==="flex"?"none":"flex",s.style.display=s.style.display==="block"?"none":"block",re(o),console.log(o.id)},v=h=>{!t.contains(h.target)&&!e.contains(h.target)&&(t.style.display="none",s.style.display="none")};e.addEventListener("click",u),document.addEventListener("click",v)}async function ye(e,o){const t=s=>{s.preventDefault(),s.stopPropagation(),Swal.fire({title:"Are you sure?",text:"You will not be able to recover this imaginary file!",icon:"error",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(async n=>{n.isConfirmed&&(await O(q(g,"entries",o.id)),console.log("refresh list"),await C())})};e.addEventListener("click",t)}function ve(e){e.addEventListener("click",async function(o){o.preventDefault();const t=document.getElementById("usernameInput").value,s=document.getElementById("secondary-color").value,n=document.getElementById("secondary-color-dark").value;try{const a=q(g,"users",p().uid),d=(await $(a)).data(),u={username:t,accentColor:s,accentColorDark:n};x()&&(console.log("base64 added to updatedData: "+x().substring(0,20)+"..."),u.avatarURL=x()),await D(a,u),window.location.href="/profile"}catch(a){console.error("db update error: "+a)}})}function we(e){e.addEventListener("click",function(o){o.preventDefault();const t=document.getElementById("emailField").value,s=document.getElementById("passwordField").value;ee(_,t,s).then(async n=>{console.log("User signed in:",n.user),window.location.href="/profile",console.log("navigate to profile")}).catch(n=>{console.error("Error:",n),Swal.fire({title:"Error signing in!",text:`${n.message}, check details!`,icon:"error",confirmButtonText:"Ok",background:"#f9f9f9",confirmButtonColor:"#3085d6",buttonsStyling:!0})})})}function be(e){const o=[];return e.toLowerCase().split(" ").forEach(n=>{let a="";for(let l of n)a+=l,o.push(a)}),o}function qe(){const e=new Date,o=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0"),s=e.getFullYear();return`${o}-${t}-${s}`}function Ee(e){e.addEventListener("click",function(o){o.preventDefault();const t=document.getElementById("emailField").value,s=document.getElementById("usernameField").value,n=document.getElementById("passwordField").value,a=document.getElementById("passwordCheckField").value,l=Se(t,s,n,a);if(l==="Valid password."){const d=be(s);te(_,t,n).then(async u=>{const v=u.user,h=qe();await P(q(g,"users",v.uid),{avatarURL:"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png",email:t,username:s,searchTokens:d,accentColor:"#e869bd",accentColorDark:"#6f0166",joined:h}),window.location.href="/profile"}).catch(u=>{Swal.fire({title:"Error registering!",text:`${u.message}, check details!, ${l}`,icon:"error",confirmButtonText:"Ok",background:"#f9f9f9",confirmButtonColor:"#3085d6",buttonsStyling:!0})})}else Swal.fire({title:"Error!",text:l,icon:"error",confirmButtonText:"Ok",background:"#f9f9f9",confirmButtonColor:"#3085d6",buttonsStyling:!0})})}function Ie(e){console.log("save button found: "+e),e.addEventListener("click",async function(o){o.preventDefault(),o.stopPropagation(),console.log("clicked save button");const t=R.journalMain(),s=W(),n=q(g,"entries",s);try{await P(n,t.toFirestore()),console.log("Document written with ID: ",s),C()}catch(a){console.error("Error adding document: ",a)}})}function Se(e,o,t,s){return t===""||s===""||e===""||o===""?"Inputfields cannot be empty.":t!==s?"Passwords do not match.":"Valid password."}class R{constructor(o,t,s,n,a,l){this.title=o,this.text=t,this.stars=s,this.category=n,this.date=a,this.userID=l}static journalMain(){var o=document.getElementById("titleInput").value,t=document.getElementById("textInput").value;o===""&&(o="untitled"),t===""&&(t="-");const s=document.getElementById("star-category"),n=s&&s.value!==""?s.value:"unrated";console.log(n);const a=document.getElementById("dream-category"),l=a&&a.value!==""?a.value:"none";console.log(l);const d=new Date,u=d.getFullYear(),v=String(d.getMonth()+1).padStart(2,"0"),y=`${String(d.getDate()).padStart(2,"0")}-${v}-${u}`,S=p().uid;return new R(o,t,n,l,y,S)}toFirestore(){return{title:this.title,text:this.text,stars:this.stars,category:this.category,date:this.date,userID:this.userID}}}function W(){const e=new Date,o=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0"),n=`${e.getFullYear()}${t}${o}`,a=oe(10);return`${n}_${a}`}console.log("main.js loaded");document.addEventListener("DOMContentLoaded",function(e){me(),console.log("DOM loaded")});async function Be(e){le(e);const o=document.getElementById("button-save"),t=document.getElementById("button-signin"),s=document.getElementById("button-register"),n=document.getElementById("button-settings-save"),a=document.getElementById("pop-button-save");await ne(_,l=>{console.log("currentUser set"),ae(l),ce(),p()?(ue(),(E()==="/settings"||E()==="/profile")&&de(),console.log(`User is signed in with UID: ${p().uid}`)):console.log("User is signed out"),E()==="/journal"?(console.log("trying to set list view content"),C(),console.log("handle save button"),Ie(o),a.addEventListener("click",he)):E()==="/settings"?(console.log("handle settings save button"),ve(n),pe()):E()==="/signin"?t?(we(t),console.log("login button found!")):console.log("login button NOT found!"):E()==="/register"?(console.log("register button found!"),Ee(s)):E()==="/friends"&&(console.log("friends button found!"),ge())})}console.log("router.js loaded");const L={404:{title:"404",template:"templates/404.html"},"/":{title:"Home",template:"templates/default.html"},"/journal":{title:"Journal",template:"templates/journal.html"},"/signin":{title:"Sign In",template:"templates/signin.html"},"/profile":{title:"Profile",template:"templates/profile.html"},"/settings":{title:"Settings",template:"templates/settings.html"},"/friends":{title:"Friends",template:"templates/friends.html"},"/register":{title:"Register",template:"templates/register.html"}},G=e=>{e=e||window.event,e.preventDefault(),window.history.pushState({},"",e.target.href),Z()},Z=async()=>{console.log("---------------SWITCHING PATH --------------");const e=window.location.pathname,o=L[e]||L[404];try{const t=await fetch(`templates/${o.template.split("/").pop()}`);t.ok||console.error(`HTTP error! status: ${t.status}`);const s=await t.text();document.getElementById("content").innerHTML=s,document.title=o.title,console.log("html loaded successfully"),console.log("path is "+e),Be(e)}catch(t){console.error("Error loading template:",t)}};window.onpopstate=Z;window.route=G;document.addEventListener("DOMContentLoaded",()=>{document.body.addEventListener("click",e=>{e.target.matches("[data-link]")&&(e.preventDefault(),G(e))}),Z()});const Te=()=>{const e=window.location.pathname;return L[e]||L[404]};window.getCurrentRoute=Te;
//# sourceMappingURL=index-BIIEDN6w.js.map
